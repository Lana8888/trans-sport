# Реализация сервиса Clients Service

Данный ADR описывает архитектурные решения, принятые для реализации сервиса <b>Clients Service</b>.

## Контекст и постановка проблемы

В процессе анализа требований к сервису <b>Clients Service</b> и проработки интеграционных решений выявлено, что объём доработок существующего <b>Clients Service</b> - довольно значительный.  

Реализация фукнкционала сервиса на базе существующего потребовала бы переработки модели данных, глубокой доработки ядра и API, доработки интеграционных механизмов внутри сервиса.
  
Поскольку сервис <b>Clients Service</b> уже существует и, скорее всего, разрабатывается и поддерживается сторонней командой разработчиков, влиять на функционал существующего <b>Clients Service</b> довольно сложно. Это потребовало бы значительных усилий на межкомандное взаимодействие, временных затрат и не гарантировало бы точного соблюдения всех требований к функциональности сервиса.

Необходимо решить проблему в обход серьёзной доработки существующего <b>Clients Service</b>.

## Факторы принятия решения

* Требования к системе предполагают значительное расширение функционала <b>Clients Service</b> в части хранения, обработки клиентских данных.
* Требования по интеграции предполагают значительные изменения интеграционных механизмов <b>Clients Service</b>.
* <b>Clients Service</b> по факту являтся "чёрным ящиком", на который наша команда имеет минимальную степень влияния.
* На этапе MVP, когда система находится на низком уровне зрелости, объём и частота изменений - велики; внедриться в чужую политику и план релизов крайне сложно.

## Варианты

* в.1 - Доработка: доработка и использование существующего <b>Clients Service</b>.
* в.2 - Замена: разработка собственного <b>Clients Service</b>, полностью замещающего существующий.
* в.3 - Прослойка: разработка собственного <b>Clients Service</b>, который будет реализовывать требуемые функции и интеграции, обогащаться информацией от существующего <b>Clients Service</b>, но не заменит его, а дополнит, выполняя роль "прослойки" между существующим <b>Clients Service</b> и другими сервисами разрабатываемой системы.

### Преимущества и недостатки в.1 (Доработка)
<b>Преимущества</b>:  
* Не нужно создавать свой сервис с нуля - уменьшение трудозатрат команды  
* Возможность использовать уже имеющиеся данные о клиентах и механизмы их обработки  
* Возможность использовать существующие API сервиса  

<b>Недостатки</b>:  
* Нет гарантий реализации требуемых фичей  
* Низкая степень влияния на сторонний сервис  
* Значительные затраты времени, которые могут сорвать контрольные точки проекта и увеличить сроки его реализации  

### Преимущества и недостатки в.2 (Замена)
<b>Преимущества</b>:  
* Полный контроль над собственным сервисом и возможность реализовать любые фичи  
* Вмозможность гибко адаптировать API и механизмы интеграции    

<b>Недостатки</b>:  
* Потеря существующих механизмов хранения и обработки клиентских данных  
* Слишком большой объём функционала, который создавался до нас, который нам полностью не известен и который придётся заместить  
* Непонятные связи и влияния на другие сервисы и системы вне нашего проекта 

### Преимущества и недостатки в.3 (Прослойка)
<b>Преимущества</b>:  
* Возможность реализации всех необходимых новых фичей с сохранением уже существующей функциональности  
* Возможность переиспользования уже существующих клиентских данных   
* Полный контроль разработки сервиса-прослойки, своя релизная политика, соблюдение КТ и сроков проекта  
* Возможность использования требуемых именно для нашей системы механизмов интеграции  

<b>Недостатки</b>:  
* Затраты на интеграцию с существующим <b>Clients Service</b>  
* Возможное дублирование данных  
* Время на синхронизацию клиентских данных между одноимёнными сервисами

## Выбранный вариант
Выбран в.3 Прослойка.  

![Вариант реализации Clients Service](https://github.com/Lana8888/trans-sport/blob/main/clients-service.png)  

## Способы минимазации недостатков  
* Затраты на интеграцию с существующим <b>Clients Service</b>: возникают только на этапе разработки, но впоследствии будет значительная экономия времени. 
* Возможное дублирование данных: неизбежное зло при такой реализации, устранить не получится, принять как данность и быть готовыми к синхронизации данных.  
* Время на синхронизацию клиентских данных между одноимёнными сервисами: проводить синхронизацию во времена минимальной загруженности сервисов (установить опытным путём для каждой локали на этапе MVP).
